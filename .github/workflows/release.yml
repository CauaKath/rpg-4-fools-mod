name: Create release

on:
  push:
    branches:
      - master

jobs:
    build-and-deploy:
      runs-on: ubuntu-22.04
      steps:
        - name: Checkout repository
          uses: actions/checkout@v4

        - name: Validate Gradle wrapper
          uses: gradle/wrapper-validation-action@v2

        - name: Setup JDK 21
          uses: actions/setup-java@v4
          with:
              java-version: 21
              distribution: 'microsoft'

        - name: Make Gradle wrapper executable
          run: chmod +x ./gradlew

        - name: Build
          run: ./gradlew build

        - name: Capture build artifacts
          uses: actions/upload-artifact@v4
          with:
              name: Artifacts

        - name: Create Release
          id: create_release
          uses: actions/create-release@v1
          env:
              GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          with:
              files: build/libs/*
              tag_name: ${{ github.ref }}
              release_name: Release ${{ github.ref }}
              body: |
                Changes in this Release:
                - Added new feature
                - Fixed bug
                - Improved performance
              draft: false
              prerelease: false